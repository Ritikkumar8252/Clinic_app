{% extends "base.html" %}
{% block body %}

<link rel="stylesheet" href="{{ url_for('static', filename='css/create_invoice.css') }}">

<h2 class="page-title">Create Invoice</h2>

<div class="invoice-container">
<form method="POST" class="invoice-form">

    <!-- Invoice Header -->
    <div class="form-row">

        <div class="form-group">
            <label>Invoice Number</label>
            <input type="text" value="{{ new_invoice_number }}" readonly disabled>
        </div>

        <div class="form-group">
            <label>Patient</label>
            <select name="patient_id" required>
                <option value="">Select Patient</option>
                {% for p in patients %}
                <option value="{{ p.id }}">{{ p.name }} ({{ p.phone }})</option>
                {% endfor %}
            </select>
        </div>

    </div>

    <!-- Description -->
    <div class="form-group">
        <label>Description</label>
        <input type="text" name="description" placeholder="Consultation, Medicines, Tests">
    </div>

    <!-- Items Table -->
    <h3 class="section-title">Invoice Items</h3>

    <table class="items-table">
        <thead>
            <tr>
                <th>Item</th>
                <th>Amount (₹)</th>
                <th></th>
            </tr>
        </thead>

        <tbody id="itemsBody">
            <tr>
                <td><input type="text" name="item_name[]" required></td>
                <td><input type="number" name="item_amount[]" class="amount-field" required></td>
                <td>
                    <button type="button" class="remove-btn" onclick="removeRow(this)">×</button>
                </td>
            </tr>
        </tbody>
    </table>

    <button type="button" id="addRowBtn" class="btn-secondary">+ Add Item</button>

    <!-- Total Amount -->
    <div class="total-box">
        <label>Total Amount</label>
        <input type="text" id="totalAmount" name="total_amount" readonly>
    </div>

    <button class="btn-primary submit-btn" type="submit">
        Create Invoice
    </button>

</form>
</div>

<script src="{{ url_for('static', filename='js/billing/create_invoice.js') }}"></script>
{% endblock %}
