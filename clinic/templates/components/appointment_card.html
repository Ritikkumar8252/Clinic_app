<style>
    .patient-address {
    font-size: 16px;
    color: black;
    margin-top: 4px;
    max-width: 260px;
    line-height: 1.3;
}

</style>
<div class="appt-card">

    <!-- LEFT: Patient Info -->
    <div class="card-left">
        <img src="{{ url_for('static', filename='patient_images/' + a.patient.image) }}" class="avatar">

        <div>
            <h3 class="name">{{ a.patient.name }}</h3>
            <!-- <p class="minor">{{ a.patient.phone }}</p> -->
            
            {% if a.patient.address %}
            <p class="patient-address">
                üìç {{ a.patient.address }}
                {% if a.patient.city %}, {{ a.patient.city }}{% endif %}
                {% if a.patient.state %}, {{ a.patient.state }}{% endif %}
                {% if a.patient.pincode %} - {{ a.patient.pincode }}{% endif %}
            </p>
            {% endif %}
            <p class="minor">ID: {{ a.patient.patient_no }}</p>
        </div>
    </div>


    <!-- MIDDLE -->
    <div class="card-middle">
        <p><strong>Date:</strong> {{ a.date }}</p>
        <p><strong>Time:</strong> {{ a.time }}</p>
        <p><strong>Visit:</strong> {{ a.type }}</p>
    </div>

    <!-- RIGHT SIDE: Status + 3-dot menu -->
    <div class="card-right">
        <span class="status-badge status-{{ a.status|lower }}">
            {{ a.status }}
        </span>

        <!-- 3 DOT MENU ICON -->
        <div class="dropdown">
            <button class="menu-btn">‚ãÆ</button>

            <div class="dropdown-menu">

                {% if a.status == 'Queue' %}
                <a href="{{ url_for('patients_bp.patient_profile', id=a.patient.id) }}">Patient Details</a>
                <a href="{{ url_for('appointments_bp.start', id=a.id) }}">Start Consultation</a>
                <a href="{{ url_for('appointments_bp.complete', id=a.id) }}">Complete</a>
                <a href="{{ url_for('appointments_bp.cancel', id=a.id) }}">Cancel</a>
                {% endif %}

                {% if a.status == 'In Progress' %}
                <a href="{{ url_for('appointments_bp.consult', id=a.id) }}">Open Consultation</a>
                <a href="{{ url_for('appointments_bp.complete', id=a.id) }}">Finish</a>
                {% endif %}

                {% if a.status == 'Completed' %}
                <a href="{{ url_for('appointments_bp.consult', id=a.id) }}">View Notes</a>
                <a href="{{ url_for('appointments_bp.prescription_pdf', id=a.id) }}" target="_blank">Prescription PDF</a>
                {% endif %}

                {% if a.status == 'Cancelled' %}
                <span class="disabled">No actions available</span>
                {% endif %}

            </div>
        </div>

    </div>

</div>
