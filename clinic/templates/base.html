<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ title if title else "ClinicCare Dashboard" }}</title>

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
    <!-- Select2 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

    <style>
        /* Disable text selection for UI elements */
.sidebar,
.topbar,
.top-banner,
.appt-header,
.page-title,
.section-title,
.stat-card,
.menu,
.logo,
.user-badge {
    user-select: none;
    cursor: default;
}
/* Logout button styled like sidebar links */
.logout-btn {
    all: unset;
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%;
    padding: 12px 16px;
    color: black;
    cursor: pointer;
    font-size: 14px;
}

.logout-btn i {
    font-size: 16px;
}

.logout-btn:hover {
    background: rgba(255, 255, 255, 0.08);
    color: black;
}


</style>
</head>

<body>

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2 class="logo">Clinic<span>Care</span></h2>

        <ul class="menu">
            <li class="{{ 'active' if request.path == '/dashboard' else '' }}">
                <a href="{{ url_for('dashboard_bp.dashboard') }}"><i class="bi bi-speedometer2"></i> Dashboard</a>
            </li>

            <li class="{{ 'active' if '/patients' in request.path else '' }}">
                <a href="{{ url_for('patients_bp.patients') }}"><i class="bi bi-people"></i> Patients</a>
            </li>

            <li class="{{ 'active' if '/appointments' in request.path else '' }}">
                <a href="{{ url_for('appointments_bp.appointments') }}"><i class="bi bi-calendar-event"></i> Appointments</a>
            </li>

            <li class="{{ 'active' if '/billing' in request.path else '' }}">
                <a href="{{ url_for('billing_bp.billing') }}"><i class="bi bi-receipt"></i> Billing</a>
            </li>

            

            <li class="{{ 'active' if '/settings' in request.path else '' }}">
                <a href="{{ url_for('settings_bp.settings') }}"><i class="bi bi-gear"></i> Settings</a>
            </li>

            <li>
                <form method="POST" action="{{ url_for('auth_bp.logout') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="logout-btn">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </button>
                </form>
            </li>

        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="topbar">
            <div class="user-badge">Hi, {{ session.get('user_email', 'User') }}</div>

            <div>
                <button class="dark-toggle" onclick="toggleDark()">üåô / ‚òÄÔ∏è</button>
            </div>
        </div>

        {% block body %}
        {% endblock %}
    </main>

    <!-- Dark Mode JS -->
    <script>
        function toggleDark() {
            document.body.classList.toggle("dark");
            localStorage.setItem("darkMode", document.body.classList.contains("dark"));
        }

        if (localStorage.getItem("darkMode") === "true") {
            document.body.classList.add("dark");
        }
    </script>
    <!-- jQuery + Select2 JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script>
        document.addEventListener("click", function(e) {
            const isMenuButton = e.target.classList.contains("menu-btn");

            document.querySelectorAll(".dropdown").forEach(d => {
                if (d.contains(e.target)) return;
                d.classList.remove("show");
            });

            if (isMenuButton) {
                const parent = e.target.closest(".dropdown");
                parent.classList.toggle("show");
            }
        });
    </script>

</body>
</html>
