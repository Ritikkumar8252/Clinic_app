{% extends "base.html" %}
{% block body %}
<style>
    /* ===== Appointments page: remove text cursor ===== */

/* Disable text selection on appointment UI */
.appt-header,
.appt-header *,

.filter-bar,
.filter-bar *,

.appt-tabs,
.appt-tabs *,

.appt-list,
.appt-list * {
    user-select: none;
    cursor: default;
}

/* Appointment cards (important) */
.appointment-card,
.appointment-card * {
    user-select: none;
    cursor: default;
}

/* Enable pointer for clickable items */
a,
button,
.btn,
.tab {
    cursor: pointer;
    user-select: none;
}

/* Keep form inputs usable */
.search-box,
.date-box,
input,
select {
    cursor: text;
    user-select: text;
}
/* Reset button */
.btn-reset {
    padding: 7px 14px;
    border-radius: 7px;
    background: #2563eb;
    color: #374151;
    text-decoration: none;
    border: 2px solid black;
    font-weight: 500;
}

.btn-reset:hover {
    background: #2563eb;
}


</style>
<!-- HEADER -->
<div class="appt-header">
    <div class="left">
        <h2>Appointments</h2>
        <p class="subtitle">Welcome Dr. {{ session['user_email'] }} — manage your schedule</p>
    </div>

    <div class="right">
        <a href="{{ url_for('appointments_bp.add_appointment') }}" class="btn btn-primary">
            + Add Appointment
        </a>

        <a href="{{ url_for('appointments_bp.walkin') }}" class="btn btn-green">
            Start Walk-In Consultation
        </a>
    </div>
</div>


<!-- FILTER BAR -->
<div class="filter-bar">

    <form method="GET" class="filter-form" action="{{ url_for('appointments_bp.appointments') }}">

        <input type="hidden" name="tab" value="{{ tab }}">

        <input type="text" 
               name="search" 
               value="{{ search }}" 
               class="search-box"
               placeholder="Search by patient name…">

        <input type="date" 
               name="date" 
               value="{{ date_filter }}"
               class="date-box">

        <button class="btn btn-primary" type="submit">Filter</button>

        <!-- RESET -->
        <a href="{{ url_for('appointments_bp.appointments') }}" 
           class="btn btn-reset">
            Reset
        </a>

    </form>

</div>




<!-- TABS -->
<div class="appt-tabs">

    <a href="?tab=queue&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='queue' else '' }}">Queue</a>

    <a href="?tab=inprogress&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='inprogress' else '' }}">In Progress</a>

    <a href="?tab=completed&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='completed' else '' }}">Completed</a>

    <a href="?tab=cancelled&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='cancelled' else '' }}">Cancelled</a>

</div>




<!-- APPOINTMENT LIST -->
<div class="appt-list">
{% if tab == 'queue' %}
    {% for a in queue %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No appointments in queue</p>
    {% endfor %}
{% endif %}

{% if tab == 'inprogress' %}
    {% for a in inprogress %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No consultations in progress</p>
    {% endfor %}
{% endif %}

{% if tab == 'completed' %}
    {% for a in completed %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No completed appointments</p>
    {% endfor %}
{% endif %}

{% if tab == 'cancelled' %}
    {% for a in cancelled %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No cancelled appointments</p>
    {% endfor %}
{% endif %}

</div>
<script src="{{ url_for('static', filename='js/appointments/date_filter.js') }}"></script>
<script src="{{ url_for('static', filename='js/appointments/appointment_search.js') }}"></script>
<script src="{{ url_for('static', filename='js/appointments/appointments.js') }}"></script>
<script src="{{ url_for('static', filename='js/appointments/add_appointment.js') }}"></script>
{% endblock %}
