{% extends "base.html" %}
{% block body %}

<!-- HEADER -->
<div class="appt-header">
    <div class="left">
        <h2>Appointments</h2>
        <p class="subtitle">Welcome Dr. {{ session['user'] }} — manage your schedule</p>
    </div>

    <div class="right">
        <a href="{{ url_for('appointments_bp.add_appointment') }}" class="btn btn-primary">
            + Add Appointment
        </a>

        <a href="{{ url_for('appointments_bp.walkin') }}" class="btn btn-green">
            Start Walk-In Consultation
        </a>
    </div>
</div>


<!-- FILTER BAR -->
<div class="filter-bar">

    <!-- Search -->
    <form method="GET" class="filter-form">
        <input type="hidden" name="tab" value="{{ tab }}">

        <input type="text" 
               name="search" 
               value="{{ search }}" 
               class="search-box"
               placeholder="Search by patient name…">

        <input type="date" 
               name="date" 
               value="{{ date_filter }}"
               class="date-box">

        <button class="btn btn-primary">Filter</button>
    </form>

</div>



<!-- TABS -->
<div class="appt-tabs">

    <a href="?tab=queue&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='queue' else '' }}">Queue</a>

    <a href="?tab=inprogress&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='inprogress' else '' }}">In Progress</a>

    <a href="?tab=completed&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='completed' else '' }}">Completed</a>

    <a href="?tab=cancelled&search={{ search }}&date={{ date_filter }}" 
       class="tab {{ 'active' if tab=='cancelled' else '' }}">Cancelled</a>

</div>




<!-- APPOINTMENT LIST -->
<div class="appt-list">
{% if tab == 'queue' %}
    {% for a in queue %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No appointments in queue</p>
    {% endfor %}
{% endif %}

{% if tab == 'inprogress' %}
    {% for a in inprogress %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No consultations in progress</p>
    {% endfor %}
{% endif %}

{% if tab == 'completed' %}
    {% for a in completed %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No completed appointments</p>
    {% endfor %}
{% endif %}

{% if tab == 'cancelled' %}
    {% for a in cancelled %}
        {% include 'components/appointment_card.html' %}
    {% else %}
        <p class="empty-state">No cancelled appointments</p>
    {% endfor %}
{% endif %}

</div>
<script src="{{ url_for('static', filename='js/appointments/date_filter.js') }}"></script>
<script src="{{ url_for('static', filename='js/appointments/appointment_search.js') }}"></script>
<script src="{{ url_for('static', filename='js/appointments/appointments.js') }}"></script>
<script src="{{ url_for('static', filename='js/appointments/add_appointment.js') }}"></script>
{% endblock %}
